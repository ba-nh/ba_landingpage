# Google 시트에 문의 저장하기 (Google Apps Script)

문의하기 버튼으로 제출된 **관심 분야**와 **이메일**을 내 Google 시트에 저장하는 설정 방법입니다.

## 1. Google 시트 만들기

1. [Google 시트](https://sheets.google.com)에서 새 스프레드시트를 만듭니다.
2. 첫 번째 행에 아래처럼 열 이름을 입력합니다 (원하면 한글로 변경 가능).

   | A (일시) | B (관심분야) | C (이메일) |
   |----------|--------------|------------|
   |          |              |            |

## 2. Apps Script에 코드 넣기

1. 시트 메뉴에서 **확장 프로그램** → **Apps Script**를 엽니다.
2. `Code.gs` 파일이 있으면 내용을 지우고, 이 폴더의 **Code.gs** 내용 전체를 복사해 붙여넣습니다.
3. **저장** (디스크 아이콘 또는 Ctrl+S) 합니다.

## 3. 웹 앱으로 배포하기

1. Apps Script 편집기에서 **배포** → **새 배포**를 클릭합니다.
2. **유형 선택** 옆 연필 아이콘 → **웹 앱**을 선택합니다.
3. 설정:
   - **설명**: 예) "문의 폼 저장"
   - **실행 사용자**: **나**
   - **액세스 권한**: **모든 사용자** (또는 "앱에 액세스할 수 있는 사용자: anyone")
4. **배포**를 누르면 **웹 앱 URL**이 나옵니다. 이 주소를 복사합니다.

## 4. 랜딩페이지에 URL 넣기

1. 프로젝트 루트에 `.env` 파일을 만들고 (없다면 `.env.example`을 복사해 `.env`로 저장),
2. 아래처럼 **복사한 웹 앱 URL**을 넣습니다.

```env
VITE_GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/여기에_나온_ID/exec
```

3. 개발 서버를 다시 실행합니다 (`npm run dev`).

이제 문의하기 폼에서 제출하면 같은 시트의 **활성 시트**에 일시, 관심분야, 이메일이 한 행씩 추가됩니다.

## 동작 방식

- 랜딩페이지의 문의 폼은 **숨겨진 form**으로 위 웹 앱 URL에 **POST**로 전송합니다.
- 전송은 **iframe**을 사용해 이루어지므로, 브라우저 CORS 제한 없이 동작합니다.
- Apps Script의 `doPost(e)`가 `e.parameter.interest`, `e.parameter.email`를 받아 시트에 `appendRow([일시, 관심분야, 이메일])`로 저장합니다.

## 문제 해결

- **데이터가 안 쌓여요**: 배포 시 "액세스 권한"을 **모든 사용자**로 했는지 확인하세요. URL이 `.env`의 `VITE_GOOGLE_SCRIPT_URL`과 정확히 같은지 확인하세요.
- **스크립트 수정 후**: 코드를 바꾼 뒤에는 **배포** → **배포 관리** → 해당 배포 옆 **수정** → **버전: 새 버전**으로 저장해야 새 코드가 반영됩니다. URL은 그대로 써도 됩니다.
